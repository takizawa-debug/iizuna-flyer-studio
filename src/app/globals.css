@import "tailwindcss";

@theme {
  --color-washi: #fdfbf7;
  --color-washi-dark: #f0ece1;
  --color-apple: #b13434;
  --color-apple-dark: #8b2323;
  --color-ink: #2c2c2c;
  --color-leaf: #4d6645;

  --font-serif: var(--font-shippori), "Shippori Mincho", serif;
  --font-sans: var(--font-noto-sans), "Noto Sans JP", sans-serif;
  --font-tsukushi: "FOT-TsukuARdGothic Std", "FOT-筑紫A丸ゴシック Std", "TsukuARdGothic-Regular", sans-serif;
}

@layer base {
  body {
    background-color: var(--color-washi);
    color: var(--color-ink);
  }
}

@layer utilities {
  .texture-paper {
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.04'/%3E%3C/svg%3E");
    background-repeat: repeat;
  }

  .texture-washi {
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 300 300' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='washiNoise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.2' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23washiNoise)' opacity='0.09'/%3E%3C/svg%3E");
    background-repeat: repeat;
  }

  .texture-ink {
    filter: url('#ink-bleed');
  }

  .wabi-rotate-1 {
    transform: rotate(0.5deg);
  }

  .wabi-rotate-2 {
    transform: rotate(-0.7deg);
  }

  .wabi-rotate-3 {
    transform: rotate(1.2deg);
  }

  .wabi-rotate-4 {
    transform: rotate(-1.5deg);
  }

  .wabi-shadow {
    box-shadow: 2px 3px 6px rgba(0, 0, 0, 0.06), 0px 1px 2px rgba(0, 0, 0, 0.04);
  }
}

/* ===== Print-to-PDF: exact A4 landscape (297mm × 210mm) ===== */
@media print {
  @page {
    size: 297mm 210mm;
    margin: 0;
  }

  /* ── Global print resets ── */
  html,
  body {
    margin: 0 !important;
    padding: 0 !important;
    background: white !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    overflow: visible !important;
    width: auto !important;
    height: auto !important;
  }

  /* Remove body texture background */
  body.is-printing {
    background-image: none !important;
  }

  /* Hide SVG filters from body */
  body.is-printing>svg {
    display: none !important;
  }

  /* ── Hide all non-content elements ── */

  /* Fixed toolbar */
  body.is-printing .fixed {
    display: none !important;
  }

  /* Progress overlay */
  body.is-printing [class*="z-\[100\]"] {
    display: none !important;
  }

  /* Section labels (h2) */
  body.is-printing h2.print\:hidden {
    display: none !important;
  }

  /* Export-hide elements */
  body.is-printing [data-export-hide] {
    display: none !important;
  }

  /* ── Remove ALL padding, margin, gap from wrapper chain ── */

  /* 1. pt-[56px] padding wrapper */
  body.is-printing .pt-\[56px\] {
    padding: 0 !important;
    margin: 0 !important;
  }

  /* 2. Root scrollable container */
  body.is-printing .overflow-auto {
    overflow: visible !important;
    padding: 0 !important;
    margin: 0 !important;
    display: block !important;
  }

  /* 3. Scale container (pb-12 flex flex-col gap-16) */
  body.is-printing .pb-12 {
    padding: 0 !important;
    margin: 0 !important;
    gap: 0 !important;
    display: block !important;
  }

  /* 4. Section wrapper (flex flex-col gap-3) */
  body.is-printing .gap-3 {
    gap: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    display: block !important;
  }

  /* ── Remove ALL shadows ── */
  body.is-printing * {
    box-shadow: none !important;
  }

  /* ── Panel sizing: exact A4 landscape ── */
  body.is-printing [data-panel] {
    display: flex !important;
    width: 840px !important;
    height: 594px !important;
    transform: scale(1.3363) !important;
    transform-origin: top left !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    margin: 0 !important;
    padding: 0 !important;
    position: relative !important;
  }

  /* Page break after front panel */
  body.is-printing [data-panel="front"] {
    page-break-after: always !important;
    break-after: page !important;
    margin-bottom: 0 !important;
  }

  body.is-printing [data-panel="back"] {
    page-break-after: auto !important;
    break-after: auto !important;
  }

  /* Prevent images from getting split across pages */
  body.is-printing img {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
}